import{_ as M,r as m,o as d,c as r,d as n,w as D,b as t,t as b,g,B as y,F as C,z as V,A as B,n as h,G as $,e as _,a as L}from"./index-63b9cbb2.js";import{c as A}from"./cart-48fe5200.js";import{P as N}from"./PaginationComponent-15c9ee95.js";import{m as k}from"./modalMixin-176ec355.js";import{S as v}from"./sweetalert2.all-517d81ab.js";import"./base-component-1b447db8.js";const S={data(){return{modal:"",productTemp:{}}},mixins:[k],props:{product:{type:Object,default(){return{}},isNew:{type:Boolean,default:!1}},isDone:{type:Boolean,default:!0},updateTitle:{type:String},updateProduct:{type:Function}},watch:{product(){this.productTemp=this.product}}},E={ref:"modal",id:"productModal",class:"modal fade",tabindex:"-1"},q={class:"modal-content border-0"},R={class:"modal-header bg-dark text-white"},F={id:"productModalLabel",class:"modal-title"},I=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),O={class:"modal-body"},j={class:"row"},z={class:"col-sm-4"},H={class:"mb-2"},G={class:"mb-3"},J=t("label",{for:"imageUrl",class:"form-label"},"輸入圖片網址",-1),K=["src"],Q=t("h5",null,"多圖設置",-1),W={key:0},X=["onUpdate:modelValue"],Y=["src"],Z={class:"col-sm-8"},tt={class:"mb-3"},et=t("label",{for:"title",class:"form-label"},[_("標題"),t("span",{class:"text-danger"}," *")],-1),ot={class:"row"},st={class:"mb-3 col-md-6"},lt=t("label",{for:"category",class:"form-label"},[_("分類"),t("span",{class:"text-danger"}," *")],-1),it={class:"mb-3 col-md-6"},nt=t("label",{for:"unit",class:"form-label"},[_("單位"),t("span",{class:"text-danger"}," *")],-1),dt={class:"row"},rt={class:"mb-3 col-md-6"},at=t("label",{for:"origin_price",class:"form-label"},[_("原價"),t("span",{class:"text-danger"}," *")],-1),ct={class:"mb-3 col-md-6"},pt=t("label",{for:"price",class:"form-label"},[_("售價"),t("span",{class:"text-danger"}," *")],-1),ut=t("hr",null,null,-1),mt={class:"mb-3"},_t=t("label",{for:"description",class:"form-label"},"課程描述",-1),ht={class:"mb-3"},bt=t("label",{for:"content",class:"form-label"},"課程說明",-1),ft={class:"mb-3"},gt={class:"form-check"},vt=t("label",{class:"form-check-label",for:"is_enabled"},"是否啟用",-1),Tt={class:"modal-footer"},yt=t("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function wt(i,e,l,f,o,c){const a=m("v-field"),p=m("error-message"),U=m("v-form");return d(),r("div",E,[n(U,{class:"modal-dialog modal-xl",onSubmit:l.updateProduct},{default:D(({errors:u})=>[t("div",q,[t("div",R,[t("h5",F,[t("span",null,b(l.updateTitle),1)]),I]),t("div",O,[t("div",j,[t("div",z,[t("div",H,[t("div",G,[J,g(t("input",{type:"text",class:"form-control",placeholder:"請輸入圖片連結","onUpdate:modelValue":e[0]||(e[0]=s=>o.productTemp.imageUrl=s)},null,512),[[y,o.productTemp.imageUrl]])]),t("img",{class:"img-fluid",src:o.productTemp.imageUrl,alt:""},null,8,K)]),t("div",null,[Q,Array.isArray(o.productTemp.imagesUrl)?(d(),r("div",W,[(d(!0),r(C,null,V(o.productTemp.imagesUrl,(s,T)=>(d(),r(C,{key:T},[g(t("input",{type:"text","onUpdate:modelValue":P=>o.productTemp.imagesUrl[T]=P,class:"form-control"},null,8,X),[[y,o.productTemp.imagesUrl[T]]]),t("img",{src:o.productTemp.imagesUrl[T],alt:"",class:"img-fluid mb-3"},null,8,Y)],64))),128)),!o.productTemp.imagesUrl.length||o.productTemp.imagesUrl[o.productTemp.imagesUrl.length-1]?(d(),r("button",{key:0,type:"button",class:"btn btn-outline-primary btn-sm d-block w-100",onClick:e[1]||(e[1]=()=>o.productTemp.imagesUrl.push(""))}," 新增圖片 ")):(d(),r("button",{key:1,type:"button",class:"btn btn-outline-danger btn-sm d-block w-100",onClick:e[2]||(e[2]=()=>o.productTemp.imagesUrl.pop())}," 刪除圖片 "))])):B("",!0)])]),t("div",Z,[t("div",tt,[et,n(a,{id:"title",name:"標題",type:"text",class:h(["form-control",{"is-invalid":u.標題}]),placeholder:"請輸入標題",rules:"required",modelValue:o.productTemp.title,"onUpdate:modelValue":e[3]||(e[3]=s=>o.productTemp.title=s)},null,8,["class","modelValue"]),n(p,{name:"標題",class:"invalid-feedback"})]),t("div",ot,[t("div",st,[lt,n(a,{id:"category",name:"分類",type:"text",class:h(["form-control",{"is-invalid":u.分類}]),placeholder:"請輸入分類",rules:"required",modelValue:o.productTemp.category,"onUpdate:modelValue":e[4]||(e[4]=s=>o.productTemp.category=s)},null,8,["class","modelValue"]),n(p,{name:"分類",class:"invalid-feedback"})]),t("div",it,[nt,n(a,{id:"unit",name:"單位",type:"text",class:h(["form-control",{"is-invalid":u.單位}]),placeholder:"請輸入單位",rules:"required",modelValue:o.productTemp.unit,"onUpdate:modelValue":e[5]||(e[5]=s=>o.productTemp.unit=s)},null,8,["class","modelValue"]),n(p,{name:"單位",class:"invalid-feedback"})])]),t("div",dt,[t("div",rt,[at,n(a,{id:"origin_price",name:"原價",type:"number",class:h(["form-control",{"is-invalid":u.原價}]),placeholder:"請輸入原價",rules:"numeric|required",modelValue:o.productTemp.origin_price,"onUpdate:modelValue":e[6]||(e[6]=s=>o.productTemp.origin_price=s),modelModifiers:{number:!0}},null,8,["class","modelValue"]),n(p,{name:"原價",class:"invalid-feedback"})]),t("div",ct,[pt,n(a,{id:"price",name:"售價",type:"number",class:h(["form-control",{"is-invalid":u.售價}]),placeholder:"請輸入售價",rules:"numeric|required",modelValue:o.productTemp.price,"onUpdate:modelValue":e[7]||(e[7]=s=>o.productTemp.price=s),modelModifiers:{number:!0}},null,8,["class","modelValue"]),n(p,{name:"售價",class:"invalid-feedback"})])]),ut,t("div",mt,[_t,g(t("textarea",{id:"description",type:"text",class:"form-control",placeholder:"請輸入課程描述","onUpdate:modelValue":e[8]||(e[8]=s=>o.productTemp.description=s)},`
                  `,512),[[y,o.productTemp.description]])]),t("div",ht,[bt,g(t("textarea",{id:"content",type:"text",class:"form-control",placeholder:"請輸入課程說明","onUpdate:modelValue":e[9]||(e[9]=s=>o.productTemp.content=s)},`
                  `,512),[[y,o.productTemp.content]])]),t("div",ft,[t("div",gt,[g(t("input",{id:"is_enabled",class:"form-check-input",type:"checkbox","true-value":1,"false-value":0,"onUpdate:modelValue":e[10]||(e[10]=s=>o.productTemp.is_enabled=s)},null,512),[[$,o.productTemp.is_enabled]]),vt])])])])]),t("div",Tt,[yt,t("button",{type:"submit",class:h(["btn btn-primary",{disabled:l.isDone===!1}])}," 確認 ",2)])])]),_:1},8,["onSubmit"])],512)}const xt=M(S,[["render",wt]]),Ct={data(){return{modal:"",productTemp:{}}},mixins:[k],props:{product:{type:Object,default(){return{}}},removeProduct:{type:Function}},watch:{product(){this.productTemp=this.product}}},Ut={ref:"modal",id:"delModal",class:"modal fade",tabindex:"-1"},Mt={class:"modal-dialog"},Vt={class:"modal-content border-0"},kt=t("div",{class:"modal-header bg-danger text-white"},[t("h5",{id:"delProductModalLabel",class:"modal-title"},[t("span",null,"刪除產品")]),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),Pt={class:"modal-body"},Dt={class:"text-danger"},Bt={class:"modal-footer"},$t=t("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function Lt(i,e,l,f,o,c){return d(),r("div",Ut,[t("div",Mt,[t("div",Vt,[kt,t("div",Pt,[_(" 是否刪除 "),t("strong",Dt,b(o.productTemp.title),1),_(" 商品(刪除後將無法恢復)。 ")]),t("div",Bt,[$t,t("button",{type:"button",class:"btn btn-danger",onClick:e[0]||(e[0]=(...a)=>l.removeProduct&&l.removeProduct(...a))}," 確認刪除 ")])])])],512)}const At=M(Ct,[["render",Lt]]);const{VITE_URL:w,VITE_PATH:x}={VITE_URL:"https://vue3-course-api.hexschool.io",VITE_PATH:"artworld",BASE_URL:"/artworld/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},Nt={data(){return{products:[],productTemp:{imagesUrl:[]},isNew:!1,updateTitle:"新增產品",page:{},isLoading:!1,isDone:!0}},components:{Pagination:N,ProductModal:xt,DelModal:At},methods:{getData(i=1){const e=`${w}/v2/api/${x}/admin/products/?page=${i}`;this.$http.get(e).then(l=>{this.products=l.data.products,this.page=l.data.pagination,this.isLoading=!1}).catch(l=>{v.fire({position:"top-end",icon:"error",color:"white",iconColor:"white",customClass:{popup:"colored-toast"},title:`${l.response.data.message}`,showConfirmButton:!1,timer:1e3,timerProgressBar:!0,toast:!0})})},openModal(i,e){if(i==="create")this.$refs.productModal.openModal(),this.isNew=!0,this.updateTitle="新增課程",this.productTemp={imagesUrl:[]};else if(i==="edit")if(this.$refs.productModal.openModal(),this.isNew=!1,this.updateTitle="編輯課程",this.productTemp={...e},!Array.isArray(this.productTemp.imagesUrl))this.productTemp.imagesUrl=[];else{const l=[];this.productTemp.imagesUrl.forEach(f=>{f!==""&&l.push(f)}),this.productTemp.imagesUrl=l}else i==="delete"&&(this.$refs.delModal.openModal(),this.productTemp={...e})},updateProduct(){this.isDone=!1;let i=`${w}/v2/api/${x}/admin/product`,e="post";this.isNew||(i=`${w}/v2/api/${x}/admin/product/${this.productTemp.id}`,e="put"),this.$http[e](i,{data:this.productTemp}).then(l=>{this.isDone=!0,v.fire({position:"top-end",icon:"success",color:"white",iconColor:"white",customClass:{popup:"colored-toast"},title:`${l.data.message}`,showConfirmButton:!1,timer:1e3,timerProgressBar:!0,toast:!0}),this.getData(),this.$refs.productModal.hideModal()}).catch(l=>{v.fire({position:"top-end",icon:"error",color:"white",iconColor:"white",customClass:{popup:"colored-toast"},title:`${l.response.data.message}`,showConfirmButton:!1,timer:1e3,timerProgressBar:!0,toast:!0})})},removeProduct(){const i=`${w}/v2/api/${x}/admin/product/${this.productTemp.id}`;this.$http.delete(i).then(e=>{v.fire({position:"top-end",icon:"success",color:"white",iconColor:"white",customClass:{popup:"colored-toast"},title:`${e.data.message}`,showConfirmButton:!1,timer:1e3,timerProgressBar:!0,toast:!0}),this.getData(),this.$refs.delModal.hideModal()}).catch(e=>{v.fire({position:"top-end",icon:"error",color:"white",iconColor:"white",customClass:{popup:"colored-toast"},title:`${e.response.data.message}`,showConfirmButton:!1,timer:1e3,timerProgressBar:!0,toast:!0})})},...L(A,["numberComma"])},mounted(){this.isLoading=!0,this.getData()}},St={class:"container py-4"},Et=t("h3",{class:"my-4"},"課程列表頁面",-1),qt={class:"text-end mt-4"},Rt={class:"table-responsive"},Ft={class:"admin_table table table-hover mt-4"},It=t("thead",{class:"table-light"},[t("tr",null,[t("th",{width:"120"}," 分類 "),t("th",null,"課程名稱"),t("th",{width:"120"}," 原價 "),t("th",{width:"120"}," 售價 "),t("th",{width:"100"}," 是否啟用 "),t("th",{width:"120"}," 編輯 ")])],-1),Ot={class:"text-start"},jt={class:"text-start"},zt={key:0,class:"text-success"},Ht={key:1},Gt={class:"btn-group"},Jt=["onClick"],Kt=["onClick"];function Qt(i,e,l,f,o,c){const a=m("VueLoading"),p=m("Pagination"),U=m("ProductModal"),u=m("DelModal");return d(),r(C,null,[n(a,{active:o.isLoading,"onUpdate:active":e[0]||(e[0]=s=>o.isLoading=s)},null,8,["active"]),t("div",St,[Et,t("div",qt,[t("button",{type:"button",class:"btn btn-primary",onClick:e[1]||(e[1]=()=>c.openModal("create"))}," 建立新的課程 ")]),t("div",Rt,[t("table",Ft,[It,t("tbody",null,[(d(!0),r(C,null,V(o.products,s=>(d(),r("tr",{key:s.id},[t("td",null,b(s.category),1),t("td",null,b(s.title),1),t("td",Ot,"NT$ "+b(i.numberComma(s.origin_price)),1),t("td",jt,"NT$ "+b(i.numberComma(s.price)),1),t("td",null,[s.is_enabled?(d(),r("span",zt,"啟用")):(d(),r("span",Ht,"未啟用"))]),t("td",null,[t("div",Gt,[t("button",{type:"button",class:"btn btn-outline-primary btn-sm",onClick:()=>c.openModal("edit",s)}," 編輯 ",8,Jt),t("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:()=>c.openModal("delete",s)}," 刪除 ",8,Kt)])])]))),128))])])]),n(p,{class:"container mt-5",pages:o.page,onChangePage:c.getData},null,8,["pages","onChangePage"]),n(U,{ref:"productModal",product:o.productTemp,"update-product":c.updateProduct,"update-title":o.updateTitle},null,8,["product","update-product","update-title"]),n(u,{ref:"delModal",product:o.productTemp,"remove-product":c.removeProduct},null,8,["product","remove-product"])])],64)}const oe=M(Nt,[["render",Qt]]);export{oe as default};
