import{_ as w,a as v,r as m,o as l,c as n,b as t,d as p,w as d,F as C,z as k,A as b,t as s,C as B,n as V,e as i}from"./index-edf686f4.js";import{c as E}from"./cart-5cd49c78.js";import{S as a}from"./sweetalert2.all-e9ed28ba.js";const{VITE_URL:f,VITE_PATH:g}={VITE_URL:"https://vue3-course-api.hexschool.io",VITE_PATH:"artworld",BASE_URL:"/artworld/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},O={data(){return{order:{products:[],id:"",is_paid:"",total:"",user:{name:"",email:"",tel:"",address:""},message:""},isDone:!0}},methods:{...v(E,["numberComma"]),getOrder(){const{id:c}=this.$route.params;this.$http.get(`${f}/v2/api/${g}/order/${c}`).then(r=>{const{order:u}=r.data;this.order=u}).catch(r=>{a.fire({position:"top-end",icon:"error",color:"white",iconColor:"white",customClass:{popup:"colored-toast"},title:`${r.response.data.message}，請再次確認。`,showConfirmButton:!1,timer:1e3,timerProgressBar:!0,toast:!0})})},payOrder(){this.isDone=!1;const{id:c}=this.$route.params;this.$http.post(`${f}/v2/api/${g}/pay/${c}`).then(()=>{a.fire({position:"top-end",icon:"success",color:"white",iconColor:"white",customClass:{popup:"colored-toast"},title:"付款成功",showConfirmButton:!1,timer:800,timerProgressBar:!0,toast:!0}),this.getOrder(),this.isDone=!0}).catch(r=>{a.fire({position:"top-end",icon:"error",color:"white",iconColor:"white",customClass:{popup:"colored-toast"},title:`${r.response.data.message}，請再次確認。`,showConfirmButton:!1,timer:1e3,timerProgressBar:!0,toast:!0})})}},mounted(){this.getOrder()}},T={class:"container py-5"},D={style:{"`--bs-breadcrumb-divider":">"},"aria-label":"breadcrumb"},R={class:"breadcrumb"},S={class:"breadcrumb-item"},L=t("li",{class:"breadcrumb-item active","aria-current":"page"},"訂單明細",-1),N={class:"mt-5"},P={class:"row"},$={class:"col-lg-7"},A={class:"table align-middle px-6"},I=t("thead",null,[t("tr",null,[t("th",null,"品名"),t("th",{class:"text-center",style:{width:"100px"}},"數量/單位"),t("th",{class:"text-center",style:{width:"100px"}},"單價")])],-1),U={class:"d-flex flex-column flex-xl-row align-items-xl-center"},H=["src"],q={class:"m-3"},z={class:"mb-1 order-content"},F={class:"d-none d-sm-block"},j=t("i",{class:"bi bi-clock me-2"},null,-1),M={key:0,class:"text-success"},G={class:"text-center order-content"},J={class:"text-center order-content"},K=t("td",{colspan:"2",class:"text-end"},"總計",-1),Q={class:"text-center order-content"},W={class:"col-lg-5 ps-lg-7"},X={class:"mb-5 row justify-content-center"},Y=t("h3",{class:"mt-5 mt-lg-0 mb-4 pb-2 border-bottom"},"訂單資料",-1),Z={class:"table ms-3"},tt=t("th",null,"訂單編號",-1),et=t("td",null,"Email",-1),st=t("td",null,"收件人姓名",-1),ot=t("td",null,"收件人電話",-1),rt=t("td",null,"收件人地址",-1),lt=t("td",null,"留言",-1),nt=t("td",null,"付款狀態",-1),ct={key:0,class:"text-success"},it={key:1,class:"text-danger"},dt=t("p",{class:"fs-5 mb-1 mt-3"},[t("i",{class:"bi bi-exclamation-square-fill me-2"}),i("訂單尚未完成")],-1),at=t("p",null,"請確認訂單明細，點選確認付款即完成訂單：）",-1),ut={class:"text-end"};function _t(c,r,u,ht,e,x){const _=m("router-link"),y=m("RouterLink");return l(),n("div",T,[t("nav",D,[t("ol",R,[t("li",S,[p(_,{to:"/"},{default:d(()=>[i("Home")]),_:1})]),L])]),t("div",N,[t("div",P,[t("div",$,[t("table",A,[I,t("tbody",null,[e.order.products?(l(!0),n(C,{key:0},k(e.order.products,o=>{var h;return l(),n("tr",{key:o.id},[t("td",U,[p(_,{to:`/course/${(h=o.product)==null?void 0:h.id}`,class:"card-title h5",style:{"min-width":"50%"}},{default:d(()=>[t("img",{src:o.product.imageUrl,style:{width:"100%","max-height":"150px"}},null,8,H)]),_:2},1032,["to"]),t("div",q,[t("p",z,s(o.product.title),1),t("p",F,[j,i(s(o.product.datetime),1)]),o.coupon?(l(),n("div",M," 已套用優惠券 ")):b("",!0)])]),t("td",G,s(o.qty)+" / "+s(o.product.unit),1),t("td",J," NT$ "+s(c.numberComma(o.total)),1)])}),128)):b("",!0)]),t("tfoot",null,[t("tr",null,[K,t("td",Q,"NT$ "+s(c.numberComma(e.order.total)),1)])])])]),t("div",W,[t("div",X,[Y,t("table",Z,[t("thead",null,[t("tr",null,[tt,t("th",null,s(e.order.id),1)])]),t("tbody",null,[t("tr",null,[et,t("td",null,s(e.order.user.email),1)]),t("tr",null,[st,t("td",null,s(e.order.user.name),1)]),t("tr",null,[ot,t("td",null,s(e.order.user.tel),1)]),t("tr",null,[rt,t("td",null,s(e.order.user.address),1)]),t("tr",null,[lt,t("td",null,s(e.order.message),1)]),t("tr",null,[nt,e.order.is_paid?(l(),n("td",ct,"已付款")):(l(),n("td",it,"未付款"))])])]),dt,at,t("div",ut,[e.order.is_paid?(l(),B(y,{key:0,to:"/courses",class:"btn btn-primary mt-5"},{default:d(()=>[i("繼續選購")]),_:1})):(l(),n("button",{key:1,type:"button",class:V([{disabled:e.isDone===!1},"btn btn-danger mt-4"]),onClick:r[0]||(r[0]=()=>x.payOrder())},"確認付款",2))])])])])])])}const ft=w(O,[["render",_t]]);export{ft as default};
