import{a as C,_ as T,o as d,c as l,b as t,t as o,F as f,i as y,j as x,e as g,g as B,s as D,r as h,d as b}from"./index-cf737877.js";import{c as w}from"./cart-2ad75db6.js";import{P as L}from"./PaginationComponent-9e245601.js";import{m as O}from"./modalMixin-5f099279.js";import{S as p}from"./sweetalert2.all-b8b31f21.js";import"./base-component-99aa02db.js";const V={data(){return{modal:"",orderTemp:{}}},mixins:[O],props:{order:{type:Object,default(){return{}}},updateOrder:{type:Function}},watch:{order(){this.orderTemp=this.order}},methods:{...C(w,["numberComma"])}},E={ref:"modal",id:"orderModal",class:"modal fade",tabindex:"-1"},N={class:"modal-dialog modal-lg"},Y={class:"modal-content border-0"},S=t("div",{class:"modal-header bg-dark text-white"},[t("h5",{id:"productModalLabel",class:"modal-title"},[t("span",null,"檢視訂單")]),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),H={class:"modal-body"},U={class:"row justify-content-center"},j={class:"col-sm-10"},A=t("h3",{class:"h4 mt-3"},"訂單資料",-1),R={class:"table mt-3"},F=t("th",{width:"120px"},"訂單編號",-1),I={class:"text-success"},q=t("th",null,"訂購日期",-1),z=t("th",null,"購買品項",-1),G={class:"text-success mb-0"},J={class:"mb-2"},K=t("h3",{class:"h4 mt-5"},"聯絡資訊",-1),Q={class:"table mt-3"},W={key:0},X=t("th",{width:"120px"},"收件人姓名",-1),Z=t("th",null,"收件人電話",-1),tt=t("th",null,"收件人信箱",-1),et=t("th",null,"收件人地址",-1),st={class:"col-sm-10"},ot={class:"form-check d-flex justify-content-end align-items-baseline"},rt={class:"mb-0"},nt={class:"text-danger fs-4"},dt=["id"],lt=t("label",{class:"form-check-label me-3",for:"`{orderTemp.id}`"},"是否付款",-1),it={key:0,class:"badge bg-success"},at={key:1,class:"badge bg-danger"},ct={class:"modal-footer"},mt=t("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function ut(r,s,n,m,e,c){return d(),l("div",E,[t("div",N,[t("div",Y,[S,t("div",H,[t("div",U,[t("div",j,[A,t("table",R,[t("tbody",null,[t("tr",null,[F,t("td",I,"[ "+o(e.orderTemp.id)+" ]",1)]),t("tr",null,[q,t("td",null,o(r.$moment(new Date(e.orderTemp.create_at*1e3)).format("YYYY-MM-DD HH:mm")),1)]),t("tr",null,[z,t("td",null,[(d(!0),l(f,null,y(e.orderTemp.products,(a,_)=>(d(),l("div",{class:"m-2",key:_},[t("p",G,"[ "+o(_)+" ]",1),t("p",J,o(a.product.title)+" x "+o(a.qty)+" / 單價：NT$ "+o(r.numberComma(a.product.price)),1)]))),128))])])])]),K,t("table",Q,[e.orderTemp.user?(d(),l("tbody",W,[t("tr",null,[X,t("td",null,o(e.orderTemp.user.name),1)]),t("tr",null,[Z,t("td",null,o(e.orderTemp.user.tel),1)]),t("tr",null,[tt,t("td",null,o(e.orderTemp.user.email),1)]),t("tr",null,[et,t("td",null,o(e.orderTemp.user.address),1)])])):x("",!0)])]),t("div",st,[t("div",ot,[t("p",rt,[g("訂單金額：NT$ "),t("span",nt,o(e.orderTemp.total),1)]),t("div",null,[B(t("input",{id:"{orderTemp.id}",class:"form-check-input ms-4 me-2",type:"checkbox","onUpdate:modelValue":s[0]||(s[0]=a=>e.orderTemp.is_paid=a)},null,8,dt),[[D,e.orderTemp.is_paid]]),lt,e.orderTemp.is_paid?(d(),l("span",it,"已付款")):(d(),l("span",at,"未付款"))])])])])]),t("div",ct,[mt,t("button",{type:"button",class:"btn btn-primary",onClick:s[1]||(s[1]=()=>n.updateOrder(e.orderTemp))}," 修改 ")])])])],512)}const pt=T(V,[["render",ut]]),_t={data(){return{modal:"",orderTemp:{}}},mixins:[O],props:{order:{type:Object,default(){return{}}},removeOrder:{type:Function}},watch:{order(){this.orderTemp=this.order}}},ht={ref:"modal",id:"delOrder",class:"modal fade",tabindex:"-1"},bt={class:"modal-dialog"},ft={class:"modal-content border-0"},gt=t("div",{class:"modal-header bg-danger text-white"},[t("h5",{id:"delProductModalLabel",class:"modal-title"},[t("span",null,"刪除訂單")]),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),$t={class:"modal-body"},vt={class:"text-danger"},yt=t("br",null,null,-1),Tt={class:"modal-footer"},Ct=t("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function xt(r,s,n,m,e,c){return d(),l("div",ht,[t("div",bt,[t("div",ft,[gt,t("div",$t,[g(" 是否刪除訂單： "),t("strong",vt,o(e.orderTemp.id),1),yt,g("(刪除後將無法恢復)。 ")]),t("div",Tt,[Ct,t("button",{type:"button",class:"btn btn-danger",onClick:s[0]||(s[0]=a=>n.removeOrder(e.orderTemp))}," 確認刪除 ")])])])],512)}const wt=T(_t,[["render",xt]]),{VITE_URL:$,VITE_PATH:v}={VITE_URL:"https://vue3-course-api.hexschool.io",VITE_PATH:"artworld",BASE_URL:"/artworld/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},Ot={data(){return{orders:[],orderTemp:{imagesUrl:[]},page:{},isLoading:!1}},components:{Pagination:L,OrderModal:pt,DelOrder:wt},methods:{getOrder(r=1){const s=`${$}/v2/api/${v}/admin/orders/?page=${r}`;this.$http.get(s).then(n=>{this.orders=n.data.orders,this.page=n.data.pagination,this.isLoading=!1}).catch(n=>{p.fire({position:"top-end",icon:"error",color:"white",iconColor:"white",customClass:{popup:"colored-toast"},title:`${n.response.data.message}`,showConfirmButton:!1,timer:1e3,timerProgressBar:!0,toast:!0})})},openModal(r,s){r==="edit"?(this.$refs.orderModal.openModal(),this.orderTemp={...s}):r==="delete"&&(this.$refs.delOrder.openModal(),this.orderTemp={...s})},updateOrder(r){const s=`${$}/v2/api/${v}/admin/order/${r.id}`,n={is_paid:r.is_paid};this.$http.put(s,{data:n}).then(m=>{p.fire({position:"top-end",icon:"success",color:"white",iconColor:"white",customClass:{popup:"colored-toast"},title:`${m.data.message}`,showConfirmButton:!1,timer:1e3,timerProgressBar:!0,toast:!0}),this.getOrder(),this.$refs.orderModal.hideModal()}).catch(m=>{p.fire({position:"top-end",icon:"error",color:"white",iconColor:"white",customClass:{popup:"colored-toast"},title:`${m.response.data.message}`,showConfirmButton:!1,timer:1e3,timerProgressBar:!0,toast:!0})})},removeOrder(r){const s=`${$}/v2/api/${v}/admin/order/${r.id}`;this.$http.delete(s).then(n=>{p.fire({position:"top-end",icon:"success",color:"white",iconColor:"white",customClass:{popup:"colored-toast"},title:`${n.data.message}`,showConfirmButton:!1,timer:1e3,timerProgressBar:!0,toast:!0}),this.getOrder(),this.$refs.delOrder.hideModal()}).catch(n=>{p.fire({position:"top-end",icon:"error",color:"white",iconColor:"white",customClass:{popup:"colored-toast"},title:`${n.response.data.message}`,showConfirmButton:!1,timer:1e3,timerProgressBar:!0,toast:!0})})},...C(w,["numberComma"])},mounted(){this.isLoading=!0,this.getOrder()}},kt={class:"container py-4"},Mt=t("h3",{class:"my-4"},"訂單列表頁面",-1),Pt={class:"table-responsive-xxl"},Bt={class:"admin_table table table-hover mt-4"},Dt=t("thead",{class:"table-light"},[t("tr",null,[t("th",null,"購買時間"),t("th",null,"Email"),t("th",null,"購買品項"),t("th",null,"應付金額"),t("th",null,"是否付款"),t("th",null,"編輯")])],-1),Lt={key:0,class:"mb-0 fs-6"},Vt={class:"text-success",style:{"font-size":"14px"}},Et={class:"text-start"},Nt={class:"list-unstyled"},Yt={class:"text-success mb-0 fs-6"},St={class:"text-dark"},Ht={class:"mb-2 fs-7"},Ut={class:"text-start"},jt={key:0,class:"text-success"},At={key:1},Rt={class:"btn-group"},Ft=["onClick"],It=["onClick"];function qt(r,s,n,m,e,c){const a=h("VueLoading"),_=h("Pagination"),k=h("OrderModal"),M=h("DelOrder");return d(),l(f,null,[b(a,{active:e.isLoading,"onUpdate:active":s[0]||(s[0]=i=>e.isLoading=i)},null,8,["active"]),t("div",kt,[Mt,t("div",null,[t("div",Pt,[t("table",Bt,[Dt,t("tbody",null,[(d(!0),l(f,null,y(e.orders,i=>(d(),l("tr",{key:i.id},[t("td",null,o(r.$moment(new Date(i.create_at*1e3)).format("YYYY-MM-DD HH:mm")),1),t("td",null,[i.user?(d(),l("p",Lt,o(i.user.email),1)):x("",!0),t("p",Vt,o(i.id),1)]),t("td",Et,[t("ul",Nt,[(d(!0),l(f,null,y(i.products,(u,P)=>(d(),l("li",{key:P},[t("p",Yt,[g(o(u.product.title)+" ",1),t("span",St,"x "+o(u.qty),1)]),t("p",Ht,"單價：NT$ "+o(r.numberComma(u.product.price)),1)]))),128))])]),t("td",Ut,"NT$ "+o(r.numberComma(i.total)),1),t("td",null,[i.is_paid?(d(),l("span",jt,"已付款")):(d(),l("span",At,"未付款"))]),t("td",null,[t("div",Rt,[t("button",{type:"button",class:"btn btn-outline-primary btn-sm",onClick:u=>c.openModal("edit",i)}," 檢視 ",8,Ft),t("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:u=>c.openModal("delete",i)}," 刪除 ",8,It)])])]))),128))])])])]),b(_,{class:"container mt-5",pages:e.page,onChangePage:c.getOrder},null,8,["pages","onChangePage"]),b(k,{ref:"orderModal",order:e.orderTemp,"update-order":c.updateOrder},null,8,["order","update-order"]),b(M,{ref:"delOrder",order:e.orderTemp,"remove-order":c.removeOrder},null,8,["order","remove-order"])])],64)}const Xt=T(Ot,[["render",qt]]);export{Xt as default};
